<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition"
        xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">

  <!-- ============================================================
       ZFI_INVOICE_STATE — Invoices by Province or State
       Migrated from SAP ABAP report ZFI_INVOICE_STATE
       Target: Epicor Kinetic — Report Data Definition + SSRS Style

       BAQ field aliases expected from RDD dataset "Results":
         StateDesc     — StateProvince.Description
         CustID        — Customer.CustID
         CustName      — Customer.Name
         InvoiceType   — InvcHead.InvoiceType
         InvoiceNum    — InvcHead.InvoiceNum
         InvoiceDate   — InvcHead.InvoiceDate
         NetValue      — Calculated field (sign-corrected amount)
         CurrencyCode  — InvcHead.CurrencyCode

       Parameters:
         pState        — State/Province code (mandatory at UI layer)
         pDateFrom     — Invoice date range start
         pDateTo       — Invoice date range end
  ============================================================ -->

  <!-- ── PARAMETERS ─────────────────────────────────────────── -->
  <ReportParameters>
    <ReportParameter Name="pState">
      <DataType>String</DataType>
      <Prompt>State / Province Code</Prompt>
    </ReportParameter>
    <ReportParameter Name="pDateFrom">
      <DataType>DateTime</DataType>
      <Prompt>Invoice Date From</Prompt>
    </ReportParameter>
    <ReportParameter Name="pDateTo">
      <DataType>DateTime</DataType>
      <Prompt>Invoice Date To</Prompt>
    </ReportParameter>
  </ReportParameters>

  <!-- ── DATA SOURCE ─────────────────────────────────────────── -->
  <!-- EpicorDB is the standard shared data source in Kinetic SSRS deployments.
       It is registered on the report server by the Kinetic installer.
       Do NOT hard-code a connection string here. -->
  <DataSources>
    <DataSource Name="EpicorDB">
      <DataSourceReference>EpicorDB</DataSourceReference>
    </DataSource>
  </DataSources>

  <!-- ── DATASET ─────────────────────────────────────────────── -->
  <!-- The CommandText is intentionally empty.
       Kinetic's report engine injects the SQL generated by the RDD/BAQ
       at runtime. Field names here must exactly match the aliases
       you set in the BAQ Designer. -->
  <DataSets>
    <DataSet Name="Results">
      <Query>
        <DataSourceName>EpicorDB</DataSourceName>
        <CommandText></CommandText>
      </Query>
      <Fields>
        <Field Name="StateDesc">
          <DataField>StateDesc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustID">
          <DataField>CustID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustName">
          <DataField>CustName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InvoiceType">
          <DataField>InvoiceType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InvoiceNum">
          <DataField>InvoiceNum</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InvoiceDate">
          <DataField>InvoiceDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="NetValue">
          <DataField>NetValue</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="CurrencyCode">
          <DataField>CurrencyCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>

  <!-- ── REPORT BODY ─────────────────────────────────────────── -->
  <Body>
    <Height>10in</Height>
    <ReportItems>

      <!-- ── MAIN TABLIX ──────────────────────────────────────── -->
      <!-- Landscape 11" page, 0.5" margins = 10" usable.
           Tablix is 9.5" wide. Column widths:
           State(1.5) + CustID(1.0) + CustName(2.0) + Type(0.75) +
           InvNum(1.0) + InvDate(1.0) + NetValue(1.5) + Currency(0.75) = 9.5"

           Row structure (must match TablixRowHierarchy below):
             Row 1 — Column headers   (static member, repeats on each page)
             Row 2 — Detail rows      (Details_Group inside StateGroup)
             Row 3 — State subtotal   (static footer inside StateGroup)
             Row 4 — Grand total      (outer static member)
      -->
      <Tablix Name="InvoiceTable">
        <DataSetName>Results</DataSetName>
        <Top>0in</Top>
        <Left>0in</Left>
        <Width>9.5in</Width>
        <Height>1in</Height>
        <Style>
          <Border><Style>None</Style></Border>
        </Style>

        <!-- ── COLUMN WIDTHS ──────────────────────────────────── -->
        <TablixBody>
          <TablixColumns>
            <TablixColumn><Width>1.5in</Width></TablixColumn>
            <TablixColumn><Width>1in</Width></TablixColumn>
            <TablixColumn><Width>2in</Width></TablixColumn>
            <TablixColumn><Width>0.75in</Width></TablixColumn>
            <TablixColumn><Width>1in</Width></TablixColumn>
            <TablixColumn><Width>1in</Width></TablixColumn>
            <TablixColumn><Width>1.5in</Width></TablixColumn>
            <TablixColumn><Width>0.75in</Width></TablixColumn>
          </TablixColumns>

          <TablixRows>

            <!-- ══ ROW 1: COLUMN HEADERS (static) ══════════════ -->
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>

                <TablixCell><CellContents>
                  <Textbox Name="H_State"><CanGrow>true</CanGrow><Value>State / Province</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_CustID"><CanGrow>true</CanGrow><Value>Customer #</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_CustName"><CanGrow>true</CanGrow><Value>Customer Name</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_Type"><CanGrow>true</CanGrow><Value>Type</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_InvNum"><CanGrow>true</CanGrow><Value>Invoice #</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_InvDate"><CanGrow>true</CanGrow><Value>Invoice Date</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_NetVal"><CanGrow>true</CanGrow><Value>Net Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <TextAlign>Right</TextAlign><PaddingRight>4pt</PaddingRight><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="H_Curr"><CanGrow>true</CanGrow><Value>Currency</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

              </TablixCells>
            </TablixRow>

            <!-- ══ ROW 2: DETAIL ROWS (Details_Group inside StateGroup) ══ -->
            <!-- Alternating row shading uses RowNumber scoped to StateGroup
                 so shading resets at the start of each state section. -->
            <TablixRow>
              <Height>0.22in</Height>
              <TablixCells>

                <TablixCell><CellContents>
                  <Textbox Name="D_State"><CanGrow>true</CanGrow><Value>=Fields!StateDesc.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_CustID"><CanGrow>true</CanGrow><Value>=Fields!CustID.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_CustName"><CanGrow>true</CanGrow><Value>=Fields!CustName.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_Type"><CanGrow>true</CanGrow><Value>=Fields!InvoiceType.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_InvNum"><CanGrow>true</CanGrow><Value>=Fields!InvoiceNum.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_InvDate"><CanGrow>true</CanGrow>
                    <Value>=Format(Fields!InvoiceDate.Value, "MM/dd/yyyy")</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <!-- Net Value: right-aligned, N2 format, red if negative -->
                <TablixCell><CellContents>
                  <Textbox Name="D_NetVal"><CanGrow>true</CanGrow><Value>=Fields!NetValue.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <Format>N2</Format><TextAlign>Right</TextAlign><PaddingRight>4pt</PaddingRight>
                      <VerticalAlign>Middle</VerticalAlign>
                      <Color>=IIF(Fields!NetValue.Value &lt; 0, "Red", "Black")</Color>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="D_Curr"><CanGrow>true</CanGrow><Value>=Fields!CurrencyCode.Value</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <BackgroundColor>=IIF(RowNumber("StateGroup") Mod 2 = 0, "WhiteSmoke", "White")</BackgroundColor>
                      <Border><Style>Solid</Style><Color>LightGray</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

              </TablixCells>
            </TablixRow>

            <!-- ══ ROW 3: STATE SUBTOTAL (static footer inside StateGroup) ══ -->
            <TablixRow>
              <Height>0.22in</Height>
              <TablixCells>

                <TablixCell><CellContents>
                  <Textbox Name="ST_Label"><CanGrow>true</CanGrow>
                    <Value>=First(Fields!StateDesc.Value) &amp; " Subtotal"</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <BackgroundColor>LightSteelBlue</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_B2"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_B3"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_B4"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_B5"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_B6"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_NetVal"><CanGrow>true</CanGrow><Value>=Sum(Fields!NetValue.Value)</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <Format>N2</Format><TextAlign>Right</TextAlign><PaddingRight>4pt</PaddingRight>
                      <VerticalAlign>Middle</VerticalAlign>
                      <Color>=IIF(Sum(Fields!NetValue.Value) &lt; 0, "DarkRed", "Black")</Color>
                      <BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="ST_Curr"><CanGrow>true</CanGrow>
                    <Value>=First(Fields!CurrencyCode.Value)</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontWeight>Bold</FontWeight>
                      <BackgroundColor>LightSteelBlue</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>SteelBlue</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

              </TablixCells>
            </TablixRow>

            <!-- ══ ROW 4: GRAND TOTAL (outer static member) ══════════════ -->
            <TablixRow>
              <Height>0.27in</Height>
              <TablixCells>

                <TablixCell><CellContents>
                  <Textbox Name="GT_Label"><CanGrow>true</CanGrow><Value>GRAND TOTAL</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>9pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>4pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_B2"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_B3"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_B4"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_B5"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_B6"><CanGrow>true</CanGrow><Value></Value>
                    <Style><BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_NetVal"><CanGrow>true</CanGrow>
                    <Value>=Sum(Fields!NetValue.Value)</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>9pt</FontSize><FontWeight>Bold</FontWeight>
                      <Format>N2</Format><TextAlign>Right</TextAlign><PaddingRight>4pt</PaddingRight>
                      <VerticalAlign>Middle</VerticalAlign>
                      <Color>=IIF(Sum(Fields!NetValue.Value) &lt; 0, "Salmon", "White")</Color>
                      <BackgroundColor>Navy</BackgroundColor>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

                <TablixCell><CellContents>
                  <Textbox Name="GT_Curr"><CanGrow>true</CanGrow>
                    <Value>=First(Fields!CurrencyCode.Value)</Value>
                    <Style><FontFamily>Arial</FontFamily><FontSize>9pt</FontSize><FontWeight>Bold</FontWeight>
                      <Color>White</Color><BackgroundColor>Navy</BackgroundColor>
                      <PaddingLeft>3pt</PaddingLeft><VerticalAlign>Middle</VerticalAlign>
                      <Border><Style>Solid</Style><Color>White</Color></Border></Style>
                  </Textbox>
                </CellContents></TablixCell>

              </TablixCells>
            </TablixRow>

          </TablixRows>
        </TablixBody>

        <!-- ── ROW HIERARCHY ────────────────────────────────────
             Must have exactly 4 leaf members matching the 4 TablixRows above:
               1. Static (header)
               2. StateGroup → Details_Group (detail)
               3. StateGroup → Static (state subtotal)
               4. Static (grand total)
        ─────────────────────────────────────────────────────── -->
        <TablixRowHierarchy>
          <TablixMembers>

            <!-- Member 1: static column header row — repeats on every page -->
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <KeepTogether>true</KeepTogether>
            </TablixMember>

            <!-- Member 2: StateGroup — groups and sorts by state/province name -->
            <TablixMember>
              <Group Name="StateGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!StateDesc.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!StateDesc.Value</Value>
                  <Direction>Ascending</Direction>
                </SortExpression>
              </SortExpressions>
              <TablixMembers>

                <!-- Member 2a: detail rows — sorted by customer name then date -->
                <TablixMember>
                  <Group Name="Details_Group"/>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!CustName.Value</Value>
                      <Direction>Ascending</Direction>
                    </SortExpression>
                    <SortExpression>
                      <Value>=Fields!InvoiceDate.Value</Value>
                      <Direction>Ascending</Direction>
                    </SortExpression>
                  </SortExpressions>
                </TablixMember>

                <!-- Member 2b: state subtotal row (static footer of StateGroup) -->
                <TablixMember>
                  <KeepWithGroup>Before</KeepWithGroup>
                </TablixMember>

              </TablixMembers>
            </TablixMember>

            <!-- Member 3: grand total row (outer static footer) -->
            <TablixMember>
              <KeepWithGroup>Before</KeepWithGroup>
            </TablixMember>

          </TablixMembers>
        </TablixRowHierarchy>

        <!-- ── COLUMN HIERARCHY — 8 static columns (no column groups) ── -->
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
          </TablixMembers>
        </TablixColumnHierarchy>

      </Tablix>
    </ReportItems>
  </Body>

  <!-- ── PAGE LAYOUT ─────────────────────────────────────────── -->
  <!-- Landscape letter: 11" wide × 8.5" tall, 0.5" margins -->
  <Page>

    <PageHeader>
      <Height>0.7in</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>

        <Textbox Name="RptTitle">
          <Value>Invoices by Province or State</Value>
          <Top>0in</Top><Left>0in</Left><Width>7in</Width><Height>0.32in</Height>
          <Style><FontFamily>Arial</FontFamily><FontSize>13pt</FontSize><FontWeight>Bold</FontWeight>
            <Color>Navy</Color><VerticalAlign>Middle</VerticalAlign></Style>
        </Textbox>

        <Textbox Name="RunDateTime">
          <Value>="Run: " &amp; Format(Now(), "MM/dd/yyyy h:mm tt")</Value>
          <Top>0in</Top><Left>7in</Left><Width>3in</Width><Height>0.32in</Height>
          <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
            <TextAlign>Right</TextAlign><VerticalAlign>Middle</VerticalAlign><Color>DimGray</Color></Style>
        </Textbox>

        <Textbox Name="ParamSummary">
          <Value>="State / Province: " &amp; Parameters!pState.Value
                 &amp; "     Date Range: "
                 &amp; Format(Parameters!pDateFrom.Value, "MM/dd/yyyy")
                 &amp; " – "
                 &amp; Format(Parameters!pDateTo.Value, "MM/dd/yyyy")</Value>
          <Top>0.34in</Top><Left>0in</Left><Width>10in</Width><Height>0.25in</Height>
          <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize><FontStyle>Italic</FontStyle>
            <Color>DimGray</Color><VerticalAlign>Middle</VerticalAlign></Style>
        </Textbox>

      </ReportItems>
      <Style/>
    </PageHeader>

    <PageFooter>
      <Height>0.28in</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="PageNum">
          <Value>="Page " &amp; Globals!PageNumber &amp; " of " &amp; Globals!TotalPages</Value>
          <Top>0in</Top><Left>0in</Left><Width>10in</Width><Height>0.28in</Height>
          <Style><FontFamily>Arial</FontFamily><FontSize>8pt</FontSize>
            <TextAlign>Center</TextAlign><Color>DimGray</Color><VerticalAlign>Middle</VerticalAlign></Style>
        </Textbox>
      </ReportItems>
      <Style/>
    </PageFooter>

    <PageHeight>8.5in</PageHeight>
    <PageWidth>11in</PageWidth>
    <LeftMargin>0.5in</LeftMargin>
    <RightMargin>0.5in</RightMargin>
    <TopMargin>0.5in</TopMargin>
    <BottomMargin>0.5in</BottomMargin>
    <Style/>
  </Page>

  <Language>en-CA</Language>

</Report>
